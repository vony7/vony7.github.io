{% extends 'base.html' %}

{% block title %}{{ mission.name }} - 任务详情{% endblock %}

{% block content %}

    <div class="mission-header" style="display: flex; align-items: center; margin-bottom: 20px;">
.
    <img src="{{ url_for('static', filename='images/patches/' ~ mission.mid|string ~ '.png') }}"
         alt="{{ mission.name }} 任务徽章"
         class="mission-patch"
         style="width: 150px; height: 150px; margin-right: 30px; object-fit: contain;"
         onerror="this.src='{{ url_for('static', filename='images/patches/default.png') }}'">

    <div class="mission-title" style="flex-grow: 1;">
      <h1>{{ mission.name }}</h1>
      <h3>{{ mission.type }}飞行任务</h3>
    </div>
  </div>
<div style="margin-top: 20px;">
    <a href="{{ url_for('edit_mission', mid=mission.mid) }}" class="button-link">
       ✏️ 编辑此任务
    </a>
</div>

<style>
    .button-link {
        display: inline-block;
        padding: 8px 15px;
        background-color: #007bff; /* 蓝色 */
        color: white;
        text-decoration: none;
        border-radius: 4px;
        font-size: 0.9em;
    }
    .button-link:hover {
        background-color: #0056b3;
    }
</style>
  <div class="mission-info" style="margin: 20px 0;">
    <style>
      .info-row { display: flex; margin: 10px 0; }
      .info-label { font-weight: bold; width: 120px; }
      .ongoing { color: #d9534f; font-weight: bold; }
    </style>

    <div class="info-row">
      <div class="info-label">任务类型:</div>
      <div>{{ mission.type }}</div>
    </div>
    <div class="info-row">
      <div class="info-label">开始时间:</div>
      <div>{{ mission.start }}</div>
    </div>
    <div class="info-row">
      <div class="info-label">结束时间:</div>
      <div>{{ mission.end if mission.end else '进行中' }}</div>
    </div>
    <div class="info-row">
      <div class="info-label">持续时间:</div>
      <div>{{ duration.display }}</div>
    </div>
    <div class="info-row">
      <div class="info-label">任务状态:</div>
      <div>
        {% if duration.status == 'completed' %}已完成
        {% elif duration.status == 'ongoing' %}<span class="ongoing">执行中</span>
        {% elif duration.status == 'future' %}<span class="ongoing">计划中</span>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="crew-list" style="margin-top: 30px;">
    <h2>飞行乘组</h2>
    {% if crew %}
      {% for astronaut in crew %}
      <div class="crew-member" style="display: flex; align-items: center; margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 4px;">
        <img class="crew-photo"
           src="{{ astronaut.photo_url }}"
           alt="{{ astronaut.name }} 照片"
           style="width: 60px; height: 60px; object-fit: cover; border-radius: 50%; border: 1px solid #ccc; margin-right: 15px;"
           onerror="this.src='/static/images/astronauts/default.jpg'">

        <div>
          <h3><a href="/astronauts/{{ astronaut.uid }}">{{ astronaut.name }}</a></h3>
          <div>批次: 第{{ astronaut.group_id }}批</div>
          <div>状态: {% if astronaut.status == 1 %}现役{% else %}退役{% endif %}</div>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <p>暂无乘组信息</p>
    {% endif %}
  </div>

  <div class="back-link" style="margin-top: 25px;">
    <a href="{{ url_for('mission_list') }}">&larr; 返回任务列表</a>
  </div>

{% endblock %}