{% extends 'base.html' %}

{% block title %}{{ page_title or 'æ‰€æœ‰ä»»åŠ¡åˆ—è¡¨' }} - ä¸­å›½èˆªå¤©æ•°æ®åº“{% endblock %}

{% block content %}
<style>
  .missions-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }

  .missions-table th,
  .missions-table td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: left;
  }

  .missions-table th {
    background-color: #f2f2f2;
  }

  .missions-table tr:hover {
    background-color: #f9f9f9;
  }

  .filter-bar {
    padding: 10px;
    background: #f9f9f9;
    border-radius: 4px;
    margin-bottom: 20px;
  }

  .filter-bar a {
    margin-right: 15px;
    font-weight: bold;
    color: #007bff;
    text-decoration: none;
  }

  .filter-bar a:hover {
    text-decoration: underline;
  }

  .filter-bar a.active {
    text-decoration: underline;
    color: #000;
    cursor: default;
  }

  .sort-arrow {
    font-size: 0.8em;
    margin-left: 5px;
  }
</style>

<h1>{{ page_title or 'æ‰€æœ‰é£è¡Œä»»åŠ¡' }}</h1>

<div style="margin: 20px 0;">
    <a href="/css-missions/interactive" class="btn-primary" style="background-color: #e67e22; padding: 10px 20px; color: white; text-decoration: none; border-radius: 5px; display: inline-block; margin-right: 10px;">
        ğŸ“Š æŸ¥çœ‹äº¤äº’å¼è¿›åº¦å›¾ (Interactive Timeline)
    </a>

    <a href="/css-missions/docking" class="btn-primary" style="background-color: #1abc9c; padding: 10px 20px; color: white; text-decoration: none; border-radius: 5px; display: inline-block;">
        ğŸ›°ï¸ æŸ¥çœ‹ç©ºé—´ç«™ç»„åˆä½“çŠ¶æ€ (Docking Status)
    </a>
</div>

<div class="filter-bar">
  <span>æŒ‰ç±»å‹ç­›é€‰:</span>

  {% set current_endpoint = request.endpoint %}

  <a href="{{ url_for(current_endpoint) }}" class="{% if not selected_type %}active{% endif %}">
    æ‰€æœ‰
  </a>

  <a href="{{ url_for(current_endpoint, type='è½½äºº') }}" class="{% if selected_type == 'è½½äºº' %}active{% endif %}">
    è½½äºº
  </a>

  <a href="{{ url_for(current_endpoint, type='è´§è¿') }}" class="{% if selected_type == 'è´§è¿' %}active{% endif %}">
    è´§è¿
  </a>

  <a href="{{ url_for(current_endpoint, type='æµ‹è¯•') }}" class="{% if selected_type == 'æµ‹è¯•' %}active{% endif %}">
    æµ‹è¯•
  </a>

  <a href="{{ url_for(current_endpoint, type='èˆ±æ®µ') }}" class="{% if selected_type == 'èˆ±æ®µ' %}active{% endif %}">
    èˆ±æ®µ
  </a>
</div>

<table class="missions-table">
  <thead>
    <tr>
      <th>ä»»åŠ¡åç§°</th>
      <th>ç±»å‹</th>
      <th>
        <a
          href="{{ url_for(current_endpoint, type=selected_type, sort_by='start', order='asc' if not (sort_by == 'start' and order == 'asc') else 'desc') }}">
          å¼€å§‹æ—¶é—´
          {% if sort_by == 'start' %}
          <span class="sort-arrow">{% if order == 'asc' %}â†‘{% else %}â†“{% endif %}</span>
          {% endif %}
        </a>
      </th>
      <th>çŠ¶æ€</th>
      <th>
        <a
          href="{{ url_for(current_endpoint, type=selected_type, sort_by='duration', order='asc' if not (sort_by == 'duration' and order == 'asc') else 'desc') }}">
          æ—¶é•¿
          {% if sort_by == 'duration' %}
          <span class="sort-arrow">{% if order == 'asc' %}â†‘{% else %}â†“{% endif %}</span>
          {% endif %}
        </a>
      </th>
      <th>ä¹˜ç»„</th>
    </tr>
  </thead>
  <tbody>
    {% for m in missions %}
    <tr>
      <td><a href="{{ url_for('mission_detail', mid=m.mid) }}"><b>{{ m.name }}</b></a></td>
      <td>
        {% if m.type == 'è½½äºº' %}ğŸ‘¤ è½½äºº
        {% elif m.type == 'è´§è¿' %}ğŸ“¦ è´§è¿
        {% elif m.type == 'èˆ±æ®µ' %}ğŸ  èˆ±æ®µ
        {% elif m.type == 'æµ‹è¯•' %}ğŸ”§ æµ‹è¯•
        {% else %}{{ m.type }}{% endif %}
      </td>
      <td>{{ m.start }}</td>
      <td>
        {% if m.status == 'completed' %}
        <span style="color: green;">â— å·²å®Œæˆ</span>
        {% elif m.status == 'ongoing' %}
        <span style="color: blue; font-weight: bold;">â— æ‰§è¡Œä¸­</span>
        {% elif m.status == 'future' %}
        <span style="color: gray;">â— è®¡åˆ’ä¸­</span>
        {% endif %}
      </td>
      <td>{{ m.duration_display }}</td>
      <td>
        {% for astronaut in m.crew %}
        <a href="{{ url_for('astronaut_profile', uid=astronaut.uid) }}">{{ astronaut.name }}</a>{% if not loop.last %},
        {% endif %}
        {% else %}
        <span style="color: #999;">-</span>
        {% endfor %}
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="6" style="text-align: center; padding: 20px; color: gray;">
        æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆç­›é€‰æ¡ä»¶çš„ä»»åŠ¡ã€‚
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}